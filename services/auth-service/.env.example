# Zoptal Authentication Service - Environment Configuration
# Copy this file to .env and configure your values

# =============================================================================
# CORE CONFIGURATION
# =============================================================================

# Server Configuration
PORT=4001
NODE_ENV=development
HOST=0.0.0.0
TRUST_PROXY=true

# Application URLs
FRONTEND_URL=http://localhost:3000
API_URL=http://localhost:4001
CORS_ORIGIN=http://localhost:3000

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL Connection
DATABASE_URL=postgresql://auth_user:auth_password@localhost:5432/zoptal_auth

# Connection Pool Settings
DB_POOL_SIZE=10
DB_CONNECTION_LIMIT=20
DB_POOL_TIMEOUT=5000
DB_STATEMENT_TIMEOUT=30000
DB_QUERY_TIMEOUT=60000
DB_TRANSACTION_TIMEOUT=120000
DB_CONNECT_TIMEOUT=10000
DB_IDLE_TIMEOUT=600000
DB_ACQUIRE_TIMEOUT=20000

# Database Logging
DB_ENABLE_LOGGING=false
DB_LOG_SLOW_QUERIES=true
DB_SLOW_QUERY_THRESHOLD=1000

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

REDIS_URL=redis://localhost:6379
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY_MS=1000

# =============================================================================
# JWT CONFIGURATION
# =============================================================================

# IMPORTANT: Generate strong secrets for production (minimum 32 characters)
JWT_SECRET=your-super-secret-jwt-key-minimum-32-characters-long
JWT_REFRESH_SECRET=your-super-secret-refresh-key-minimum-32-characters-long
JWT_ACCESS_TOKEN_EXPIRY=15m
JWT_REFRESH_TOKEN_EXPIRY=7d
JWT_ALGORITHM=HS256

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================

# SendGrid Email Service
SENDGRID_API_KEY=SG.your-sendgrid-api-key
EMAIL_FROM=noreply@zoptal.com
EMAIL_REPLY_TO=support@zoptal.com

# Twilio SMS Service
TWILIO_ACCOUNT_SID=ACyour-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# =============================================================================
# OAUTH PROVIDERS (Optional)
# =============================================================================

# Google OAuth
GOOGLE_CLIENT_ID=your-google-oauth-client-id
GOOGLE_CLIENT_SECRET=your-google-oauth-client-secret

# GitHub OAuth
GITHUB_CLIENT_ID=your-github-oauth-client-id
GITHUB_CLIENT_SECRET=your-github-oauth-client-secret

# =============================================================================
# RATE LIMITING
# =============================================================================

# Global Rate Limiting
RATE_LIMIT_WINDOW=15m
RATE_LIMIT_MAX_REQUESTS=100

# Authentication Rate Limiting
RATE_LIMIT_LOGIN_MAX=5
RATE_LIMIT_LOGIN_WINDOW=15m
RATE_LIMIT_REGISTER_MAX=3
RATE_LIMIT_REGISTER_WINDOW=1h

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Password Security
BCRYPT_ROUNDS=12
PASSWORD_MIN_LENGTH=8

# Account Security
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION=15m
PASSWORD_RESET_EXPIRY=1h
EMAIL_VERIFICATION_EXPIRY=24h

# Two-Factor Authentication
OTP_SECRET=your-otp-secret-key-for-2fa-minimum-32-chars
OTP_EXPIRY_MINUTES=10

# =============================================================================
# SESSION CONFIGURATION
# =============================================================================

SESSION_SECRET=your-super-secure-session-secret-min-32-chars
SESSION_MAX_AGE_MS=86400000
MAX_CONCURRENT_SESSIONS=5

# =============================================================================
# LOGGING & MONITORING
# =============================================================================

# Logging Configuration
LOG_LEVEL=info
ENABLE_REQUEST_LOGGING=true

# Monitoring (Optional)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
HEALTH_CHECK_ENDPOINT=/health

# =============================================================================
# FEATURE FLAGS
# =============================================================================

ENABLE_2FA=true
ENABLE_OAUTH=true
ENABLE_EMAIL_VERIFICATION=true
ENABLE_PHONE_VERIFICATION=true

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================

BACKUP_ENABLED=true
BACKUP_RETENTION_DAYS=30
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_GPG_RECIPIENT=ops@yourdomain.com
ENABLE_S3_BACKUP=false
S3_BACKUP_BUCKET=your-backup-bucket-name
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_REGION=us-east-1

# =============================================================================
# NOTIFICATION CONFIGURATION
# =============================================================================

SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
NOTIFICATION_EMAIL=admin@yourdomain.com
BACKUP_WEBHOOK_URL=https://your-monitoring-service.com/webhooks/backup

# =============================================================================
# ADVANCED SECURITY FEATURES
# =============================================================================

ENABLE_DEVICE_FINGERPRINTING=true
ENABLE_IP_BLOCKING=true
ENABLE_SUSPICIOUS_ACTIVITY_DETECTION=true
PASSWORD_HISTORY_COUNT=5
ENABLE_GDPR_FEATURES=true
DATA_RETENTION_ENABLED=true
CONSENT_MANAGEMENT_ENABLED=true

# =============================================================================
# CIRCUIT BREAKER CONFIGURATION
# =============================================================================

CIRCUIT_BREAKER_ENABLED=true
DB_CIRCUIT_BREAKER_THRESHOLD=5
DB_CIRCUIT_BREAKER_TIMEOUT=60000
REDIS_CIRCUIT_BREAKER_THRESHOLD=3
REDIS_CIRCUIT_BREAKER_TIMEOUT=30000
EMAIL_CIRCUIT_BREAKER_THRESHOLD=10
EMAIL_CIRCUIT_BREAKER_TIMEOUT=120000

# =============================================================================
# WEBHOOK CONFIGURATION
# =============================================================================

WEBHOOK_ENABLED=true
WEBHOOK_EVENTS_ENABLED=true
WEBHOOK_RATE_LIMIT_ENABLED=true
WEBHOOK_RATE_LIMIT_MAX=100
WEBHOOK_RATE_LIMIT_WINDOW=300

# =============================================================================
# AVATAR & FILE UPLOAD
# =============================================================================

AVATAR_UPLOAD_ENABLED=true
AVATAR_MAX_SIZE=5242880
AVATAR_ALLOWED_TYPES=image/jpeg,image/png,image/webp
AVATAR_STORAGE_PATH=./uploads/avatars
ENABLE_GRAVATAR=true

# =============================================================================
# PRODUCTION NOTES
# =============================================================================

# For production deployment:
# 1. Generate secure, random secrets (use: openssl rand -base64 32)
# 2. Set NODE_ENV=production
# 3. Use environment-specific database URLs
# 4. Configure proper CORS origins
# 5. Set up proper monitoring and logging
# 6. Ensure all required secrets are set
# 7. Review and adjust rate limiting settings
# 8. Configure backup and disaster recovery